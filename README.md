# TwitterMap
Robert Cornacchia (rlc2160)
Oriana Fuentes (oif2102)
COMS 6998 Cloud Computing and Big Data		
Professor Sahu		

TweetMap
##Overview
The TweetMap plots Tweets that mention prominent current and recent presidential candidates in the 2016 US election. The Tweets were sourced using the Twitter streaming API, filtering by candidate names in the text and by the availability of a geolocation. The sample includes Tweets mentioning Hillary Clinton, Donald Trump, Bernie Sanders, Ted Cruz, Marco Rubio, Ben Cason, John Kasich, Jeb Bush, Carly Fiorina and Mike Huckabee for a total of 10 candidates.  

##Implementation
This application is built with Node.js on top of AWS Elastic BeanStalk and AWS ElasticSearch for persistent storage and search. The frontend uses Bootstrap and JQuery, as well as the Paper Bootswatch Theme (http://bootswatch.com/paper/). Server.js is the name of the node.js file, while app.js handles all front-end logic.  
	The application can filter tweets by name and/or by location. The dropdown-menu in the top left indicates the candidate name being searched for. The default is “All Candidates,” which means that all tweets are shown at the start. In order to see the content of a tweet, a user can simply click on a marker on the map. To filter by distance, the user simply clicks on the map, which clears all tweets and shows only the tweets that match the distance (and filters according to candidate name selected). The default search radius is 1000 km. This search range can be altered by entering a new range in the top right and clicking the “Submit” button. After clicking, the user can keep clicking to adjust the search. The search will obtain the coordinates of wherever the user clicked and search using the global range variable to determine a search radius. The click is the center of the search area.  
	These searches are handled with two routes, getTweets and getTweetsWithLocation. The first requires a candidate name as an argument, while the latter requires candidate name, latitude, longitude, and search range. The client goes through the server to query the ElasticSearch database. While earlier versions allowed the client to directly query the database, this was insecure, so we added these two routes.
	After a user is done searching using geolocation, there is the problem of how to return to the original state before any geofiltering occurred. For that purpose, we implemented a Reset button which cleared the tweets, but kept the current candidate selected. Of course, the user can also just reselect the candidate from the drop-down but that is unintuitive.    
	Earlier versions of this application used ElasticSearch.js, a npm module that allows simple interaction with ElasticSearch APIs. This worked great until we got to deployment. For some reason, AWS Elastic BeanStalk would not accept node projects with this module. After a lot of time spent debugging, we decided to remove this package and query the ElasticSearch database using http requests.  
	In order to run locally, the only change that needs to be made is to edit the file: public/app.js. Simply comment out the lines declaring tweetsURL and locationURL and uncomment the lines that come before and declare the exact same variables but with different URLS (that include localhost). Obviously, when deployed on AWS, the client needs to communicate with the AWS server, not localhost.   
	The sample of Tweets was captured using the Twitter streaming API, filtering by the 10 candidate names and taking only Tweets which included a geolocation. Only the Tweet ID, text and longitude and latitude were subsequently stored into Elasticsearch to reduce storage needs. The index includes a location field created with geolocation properties to allow for geospatial search and filtering. The application includes a Google Maps API which displays pins with text representing the sample set or subset of Tweets based on the user input at the top of the page, initially defaulting to the whole sample. Upon clicking a filter, either the candidate dropdown or clicking on the map, the app will post the server to query the Elasticsearch database. The query will either match text (in case of candidate name) or filter Tweets by location within the defined ranged around a selected point on the map. After the search is completed, the array of tweets is plotted on the map with Google Maps markers according to longitude and latitude that include the Tweet text. The map is cleared of markers before plotting the results of a new query.  
